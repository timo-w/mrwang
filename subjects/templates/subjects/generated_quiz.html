{% extends "base.html" %}
{% load static %}

{% block title %}Generated Quiz{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'subjects/css/subjects.css' %}">
<link rel="stylesheet" href="{% static 'subjects/css/quiz.css' %}">
{% endblock %}

{% block content %}
<div>
  <a href="javascript:history.back()" class="back-button">&lt; Back to Module</b></a>
</div>

<h1>Generated Quiz</h1>
<p>This quiz was generated using the resource you selected. AI can make errors, so ask your teacher if you don&apos;t understand a question.</p>

<div class="quiz-container">
  <h4 id="quizResult">Select your answers and click &quot;Submit Quiz&quot; to see your score.</h4>
  <br><hr><br>

  <form id="quizForm">
    {% for q in quiz_questions %}
      <div class="quiz-question" data-correct="{{ q.correct_answer }}">
        <h4>{{ forloop.counter }}. {{ q.question }}</h4>
        <ul>
          {% for choice in q.choices %}
            <li>
              <label>
                <input type="radio" name="question{{ forloop.parentloop.counter }}" value="{{ choice }}">
                {{ choice }}
              </label>
            </li>
          {% endfor %}
        </ul>
        <div class="explanation-box" style="display:none;"></div>
        <button type="button" class="explain-btn" style="display:none;">Explain answer.</button>
      </div>
      <br><hr><br>
    {% endfor %}
    <button type="button" class="launch-btn" onclick="submitQuiz()">Submit Quiz</button>
  </form>
</div>

<!-- CSRF Token -->
<form id="csrf-form" style="display:none;">
  {% csrf_token %}
</form>
{% endblock %}

{% block js %}
<script>
  // Get CSRF token from hidden form
  const csrftoken = document.querySelector('#csrf-form input[name="csrfmiddlewaretoken"]').value;
</script>
<script src="{% static 'subjects/js/quiz.js' %}"></script>
{% endblock %}